<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard ‚Äì CodeSense</title>
  <link rel="stylesheet" href="./css/style.css" />
</head>
<body class="app-body">
  <div id="global-loader" class="loader-overlay">
    <div class="loader"></div>
  </div>

  <aside class="sidebar">
    <div class="logo">CodeSense</div>
    <nav>
      <button id="theme-toggle" class="theme-toggle-btn">
      <span class="theme-icon">‚òÄÔ∏è</span>
      <span class="theme-text">Toggle Theme</span>
      </button>
      <a href="profile.html">Profile</a>
      <a href="dashboard.html" class="active">Dashboard</a>
      <a href="explain.html">Explain Code</a>
      <a href="convert.html">Convert Code</a>
      <a href="history.html">History</a>
      <a href="stats.html">Statistics</a>
      <a href="admin.html" id="admin-link" style="display:none;">Admin</a>
      <button id="logout-btn" class="ghost-btn">Logout</button>
    </nav>
  </aside>

  <main class="app-main">
    <h1>Welcome back!</h1>
    <p>Quick actions:</p>
    <div class="grid">
      <a href="explain.html" class="card">Explain Code</a>
      <a href="convert.html" class="card">Convert Code</a>
      <a href="history.html" class="card">View History</a>
      <a href="stats.html" class="card">Statistics</a>
    </div>
  </main>

  <script type="module">
    import { requireAuth, getUser, clearToken } from "./js/common.js";
    requireAuth();
    const user = getUser();
    const adminLink = document.getElementById("admin-link");
    if (user && user.role === "admin") adminLink.style.display = "block";

    document.getElementById("logout-btn").addEventListener("click", () => {
      clearToken();
      window.location.href = "login.html";
    });
  </script>
  <script type="module">
  import { toggleTheme, initTheme } from "./js/common.js";
  
  // Initialize theme
  initTheme();
  
  // Add theme toggle functionality
  const themeToggle = document.getElementById("theme-toggle");
  if (themeToggle) {
    themeToggle.addEventListener("click", () => {
      const newTheme = toggleTheme();
      const icon = themeToggle.querySelector(".theme-icon");
      if (icon) {
        icon.textContent = newTheme === "dark" ? "‚òÄÔ∏è" : "üåô";
      }
    });
  }
</script>
</body>
</html>